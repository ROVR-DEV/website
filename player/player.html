<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <iframe id="sc-widget" src="" width="100%" height="150" scrolling="no" frameborder="no" allow="autoplay"></iframe>

    <script src="./jquery-3.7.1.min.js"></script>
    <script src="./sc-player.js"></script>

    <script>
        const iframe = $("#sc-widget")[0];

        const getParams = (param) => {
            const searchParams = new URLSearchParams(window.location.search);
            return searchParams.get(param);
        }

        $(iframe).attr('src', `https://w.soundcloud.com/player/?url=${getParams('url')}`);

        const player = SC.Widget(iframe);

        player.bind(SC.Widget.Events.READY, () => {
            console.log('ready');
        });

        const togglePlayer = () => {
            player.toggle();
            console.log('togglePlayer called');
        }

        window.addEventListener('message', (event) => {
            const { action } = event.data;

            if (action === 'togglePlayer') {
                togglePlayer();
            }
        }, false);
    </script>
</body>
</html>